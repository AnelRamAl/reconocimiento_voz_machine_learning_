import numpy as np
import math
import scipy.io.wavfile as waves
import matplotlib.pyplot as plt
import scipy.fftpack as fourier
from scipy.io import wavfile
import librosa
import librosa.display
#from mpl_toolkits.mplot3d import Axes3D
from sklearn.neighbors import KNeighborsClassifier


###algortimo K-NN 

####    ENERGÍA VS RMS   #####

RMSxBart = [0.00018329979767715355, 0.00018116778731912137, 0.00019118560279751624, 0.00019653234778635963, 0.00017730695929158208, 0.00021073382228239306, 0.000154655408770606, 0.00023091444947967546, 0.000184514277545585, 0.00019458089800099447, 0.00018371397917486086, 0.00033997637292114673, 0.00018274902949877274, 0.00016620746189279677, 0.00026255838504634586]
EnergiaBart = [1947.6974765757207, 1523.1761522233764, 1304.6770520577008, 1361.9095070478259, 1351.7660422968488, 996.0018650954887, 743.0500131810958, 1141.3389003289465, 556.6867312877805, 630.2914417655624, 756.9654728110764, 885.9916221344104, 856.3370160488621, 858.2006812177403, 1147.6059424199682]
MFCCBart = [121374.94708254383, 111531.56376956026, 100748.32774782703, 96911.49496421714, 104572.74206885681, 79943.21245762288, 85808.04655545321, 78949.92949946548, 61112.25157966995, 65380.39484413915, 73020.88915689105, 46603.80946342153, 75966.17350572492, 91296.3240916312, 68409.36608085265]
CentroideBart = [0.04470434886146516, 0.040506359735379145, 0.08463694844175307, 0.07599770024017719, 0.07430384241924926, 0.07808903442947589, 0.10071504664531884, 0.07688713800039153, 0.08491011148694834, 0.09305062679080346, 0.06226242391034769, 0.1001643498476496, 0.0970422805194362, 0.07517853237359384, 0.06713780897240625]


RMSxHOMERO = [0.00031406356771222316, 0.00024116512146829075, 0.00027152829798202067, 0.00020199980000117104, 0.00014579748509562754, 0.0001817476147970546, 0.00024471518143457223, 0.0001834712645669919, 0.000243908315862514, 0.0002552642765396076, 0.0002504575474573831, 0.0002042555613213597, 0.0003055392564060554, 0.00015006175197009977, 0.0001848485998771762]
EnergiaHOMERO = [923.6313175111222, 1622.818533287854, 939.6958399666279, 2456.7787327791825, 2998.059335513808, 2179.9780677847716, 1343.1158925166867, 2530.433805531163, 789.5109779944112, 1818.1137209802027, 1120.1835319378467, 1417.4008978333247, 1874.343635006793, 1317.9033826955708, 1234.5400324734194]
MFCCHomero = [39757.73016175888, 77509.06536193876, 51566.85776865138, 130324.4491023485, 214881.2126227047, 126974.76575988851, 72243.94671776603, 145044.0087896247, 57000.65506598271, 79959.42181153351, 58908.199172700784, 87960.17864583364, 63432.95974211959, 122588.9224250274, 90877.74907554741]
CentroideHomero = [0.050093302827707915, 0.04240378872718643, 0.033645475624829356, 0.04208578963313535, 0.04930338833454074, 0.03630975716823465, 0.04124970865715199, 0.03780383209005141, 0.041457113544353406, 0.04178148137042915, 0.0404961732646661, 0.057479957417729065, 0.036605016046618914, 0.05683204391172659, 0.04833459866081245]


RMSxLISA = [0.00011873432080843139, 0.0001342310390142828, 0.0001888507392910021, 0.0002457785119012098, 0.00022005592871048667, 0.00019499392105066005, 0.00020845845466839545, 0.00023907311029266153, 0.00014058170102509648, 0.00017409194755541976, 0.0002638645276383354, 0.00017999177740239355, 0.0001715015670900869, 0.000264956814764859, 0.00014349708983740384]
EnergiaLISA = [592.7854119555408, 927.9900382666177, 1619.891003933503, 450.9364128677889, 1069.4254773699643, 775.8727042022073, 1051.021313425493, 1444.5234428511128, 868.7710129777586, 953.9020174977557, 683.3825438055663, 980.3116954832941, 949.92723726988, 510.1743102366901, 312.8662383666862]
MFCCLisa = [108826.88664782482, 134371.8597978798, 110507.59049797419, 38047.0347431434, 73943.87457537751, 69566.11332683297, 72440.66052927791, 84666.0077656647, 116253.35416971991, 98389.33799997905, 47109.920802017165, 92757.11821604084, 86941.3606406817, 43089.20977235213, 64076.92501155543]
CentroideLisa = [0.054084918828252816, 0.0519328015560478, 0.05752194770535806, 0.05306387770770755, 0.05549995006887041, 0.062030216406721066, 0.04830303802001077, 0.045113835343235514, 0.07563252838811675, 0.05940953017032936, 0.05790825841719239, 0.053686729655184964, 0.056140822579464525, 0.06180497510291182, 0.08165087024258533]


RMSxMARCH = [8.024098471134326e-05, 7.691658436506191e-05, 0.00010432839537212521, 0.00014382371820042796, 0.00016594222992145203, 0.0001699753205904926, 0.00017341405109816847, 0.00014566783628784777, 0.00017548215949991496, 0.00021865229802625643, 0.00018015279437190196, 0.0001389128814305196, 0.00015711131182467877, 0.0001946260588496545, 0.00018307418881187898]
EnergiaMARCH = [486.2087779945012, 441.00308825224647, 329.35473253889126, 1661.2546006824366, 543.9243020766224, 1284.0409538910696, 971.2314174944028, 1313.8318904588978, 871.1172428198894, 1088.8188771144678, 893.1243872477048, 1065.73770910451, 817.7753993087605, 836.5393131443782, 598.5151852510904]
MFCCMarch = [151032.72506868505, 156505.28354748437, 90636.88259024186, 147400.54661993947, 64375.003515113094, 101740.3276196617, 86215.82642857944, 125085.27938168094, 87074.28353095936, 75744.04630851124, 85849.75106735347, 115669.89161403352, 92604.42032694971, 72285.32497916897, 62268.61038135746]
CentroideMarch = [0.04514438141360031, 0.04889282405687871, 0.04567338759136619, 0.047812114334660594, 0.035738424355574686, 0.04276456281842144, 0.04269963600908998, 0.045171916432901575, 0.04097111779115785, 0.04717531018665366, 0.03702338996269164, 0.043400826769119924, 0.039260095078003106, 0.03819061079749126, 0.04240758555401088]


RMSxSrBURNS = [0.00027545321886987887, 0.0002443592459102337, 0.00029328973903772307, 0.00019579621638780067, 0.00023547241814242135, 0.00028151113826582313, 0.00033138530196992667, 0.0002165495542055594, 0.0002337163079640073, 0.00023146620720850336, 0.00025263314728577997, 0.0002965476520191653, 0.00017670200217919174, 0.00027052786645989597, 0.0003250040012045291]
EnergiaSrBURNS = [1746.551401734617, 2618.1987497331925, 2113.127562307925, 1215.3389722211316, 2656.3925132221607, 2032.0094546002215, 1428.373655538964, 2692.441129210988, 1116.1018277566743, 1920.6206160867985, 3776.565967257659, 1075.564362003366, 2976.168303744433, 2066.0744906890545, 1727.7915247145138]
MFCCSrBurns = [67046.45629813893, 100001.32960732405, 77697.27927316152, 85605.90700074518, 112829.0468244683, 72469.03616686462, 52718.11256536594, 113904.52210234755, 61867.44427485746, 84081.98779403983, 108800.05448513637, 49493.2857139087, 165187.55741895913, 78783.19361836811, 62589.81007078671]
CentroideSrBurns = [0.08228177113692889, 0.08467104789890423, 0.06767709471664524, 0.07563207949236266, 0.06227825536891714, 0.07394139375601905, 0.08186796921827849, 0.07738082233910842, 0.08164217853985663, 0.07377244428289663, 0.07633175842073599, 0.09461267298963054, 0.06861959472674121, 0.08142781782303486, 0.08392860571403778]


#### 
entrenamiento = []
                  #  primeros 15 son BART      "0"
for x in range(0,15):
	aux = []
	aux.append(MFCCBart[x])
	aux.append(CentroideBart[x])
	aux.append(RMSxBart[x])
	aux.append(EnergiaBart[x])
	
	entrenamiento.append(aux)
				  #  segundos 15 son HOMERO      "1"
for x in range(0,15):
	aux = []
	aux.append(MFCCHomero[x])
	aux.append(CentroideHomero[x])
	aux.append(RMSxHOMERO[x])
	aux.append(EnergiaHOMERO[x])
	
	entrenamiento.append(aux)
					#  segundos 15 son LISA      "2"
for x in range(0,15):
	aux = []
	aux.append(MFCCLisa[x])
	aux.append(CentroideLisa[x])
	aux.append(RMSxLISA[x])
	aux.append(EnergiaLISA[x])
	
	entrenamiento.append(aux)
					#  segundos 15 son MARCH      "3"
for x in range(0,15):
	aux = []
	aux.append(MFCCMarch[x])
	aux.append(CentroideMarch[x])
	aux.append(RMSxMARCH[x])
	aux.append(EnergiaMARCH[x])
	
	entrenamiento.append(aux)
					#  segundos 15 son SR BURNS    "4"
for x in range(0,15):
	aux = []
	aux.append(MFCCSrBurns[x])
	aux.append(CentroideSrBurns[x])
	aux.append(RMSxSrBURNS[x])
	aux.append(EnergiaSrBURNS[x])
	
	entrenamiento.append(aux)

### ENTRENAMIENTO EN PARAMETROS DE FRECUENCIA

label = []

for x in range(0,15):
	label.append(0)

for x in range(0,15):
	label.append(1)

for x in range(0,15):
	label.append(2)

for x in range(0,15):
	label.append(3)

for x in range(0,15):
	label.append(4)

print(label)
print(len(label))
print(len(entrenamiento))

### PRUEBA 

	# prueba homero dieciseis
RMSxPRUEBA = 0.0002406382096732008
EnergiaPRUEBA = 831.1909622766192
MFCCPRUEBA = 54312.95675085927
CentroidePRUEBA = 0.05666223064351414

"""
	# prueba homero diecisiete
RMSxPRUEBA = 0.00026949921979897983
EnergiaPRUEBA = 1506.052143936759
MFCCPRUEBA = 69672.63489821025
CentroidePRUEBA = 0.044990869861902705

# prueba BART dieciseis
RMSxPRUEBA = 0.0001892606526969203
EnergiaPRUEBA = 803.3639322266316
MFCCPRUEBA = 75859.3374556051
CentroidePRUEBA = 0.08690609887303809

# prueba BART diecisiete
RMSxPRUEBA =  0.0001761063836618895
EnergiaPRUEBA =  1729.6685074992058
MFCCPRUEBA = 131912.5525196431
CentroidePRUEBA = 0.08588700488774385

# prueba LISA dieciseis
RMSxPRUEBA = 0.00024691380371262794
EnergiaPRUEBA = 1608.5476226946319
MFCCPRUEBA = 86411.56294189784
CentroidePRUEBA = 0.050577628070454204

# prueba LISA diecisiete
RMSxPRUEBA =  0.00014807677722852129
EnergiaPRUEBA =  172.5282892900188
MFCCPRUEBA =  48446.66181254773
CentroidePRUEBA = 0.04975933771391612

# prueba MARCH dieciseis
RMSxPRUEBA = 0.0001404460440606753
EnergiaPRUEBA = 435.6155765522279
MFCCPRUEBA = 73388.09598820713
CentroidePRUEBA = 0.042920111952456805

# prueba MARCH diecisiete
RMSxPRUEBA =   0.00022874371005302446
EnergiaPRUEBA =  855.557567983278
MFCCPRUEBA = 62938.79456243338
CentroidePRUEBA =  0.04130718826316536

# prueba Sr BURNS dieciseis
RMSxPRUEBA = 0.0002615003583689419
EnergiaPRUEBA = 1230.900779535624
MFCCPRUEBA = 61057.62830210122
CentroidePRUEBA = 0.0716813869464788

# prueba Sr BURNS diecisiete
RMSxPRUEBA =   0.0002665641414629448
EnergiaPRUEBA =  1039.649647541123
MFCCPRUEBA = 59062.835169392776
CentroidePRUEBA = 0.08421665225633418


# prueba MILHOUSE diecisiete
RMSxPRUEBA =   0.0001693933551066872
EnergiaPRUEBA =  1126.5606874622304
MFCCPRUEBA = 113475.20759155416
CentroidePRUEBA = 0.0798489720199051

# prueba Sr BURNS diecisiete
RMSxPRUEBA =   0.0003243245164520746
EnergiaPRUEBA =  673.1929086199807
MFCCPRUEBA = 34902.311456649
CentroidePRUEBA = 0.024039185502110285
"""
## DANDO FORMATO a PRUEBA
aux = []
PRUEBA = []
aux.append(MFCCPRUEBA)
aux.append(CentroidePRUEBA)
aux.append(RMSxPRUEBA)
aux.append(EnergiaPRUEBA)

PRUEBA.append(aux)


algortimo = KNeighborsClassifier(n_neighbors=7)
algortimo.fit(entrenamiento,label) 
respuestaLABEL = algortimo.predict(PRUEBA)
print("label ",respuestaLABEL)

"""
plt. figure(1)
plt.title('Energía vs RMS')
plt.scatter([RMSxBart],[EnergiaBart], color=['blue'], label= "BART")
plt.scatter([RMSxHOMERO],[EnergiaHOMERO], color=['green'], label= "HOMERO")
plt.scatter([RMSxLISA],[EnergiaLISA], color=['red'], label= "LISA")
plt.scatter([RMSxMARCH],[EnergiaMARCH], color=['yellow'], label= "MARCH")
plt.scatter([RMSxSrBURNS],[EnergiaSrBURNS], color=['magenta'], label= "Sr BURNS")
plt.scatter([RMSxPRUEBA],[EnergiaPRUEBA], color=['cyan'], marker = "*",label= "PRUEBA")

plt.xlabel('RMSx')
plt.ylabel('Energía')
plt.legend()

plt. figure(2)
plt.title("MFCC vs Centroide")

plt.scatter([MFCCBart],[CentroideBart], color=['blue'], label= "BART")
plt.scatter([MFCCHomero],[CentroideHomero], color=['green'], label= "HOMERO")
plt.scatter([MFCCLisa],[CentroideLisa], color=['red'], label= "LISA")
plt.scatter([MFCCMarch],[CentroideMarch], color=['yellow'], label= "MARCH")
plt.scatter([MFCCSrBurns],[CentroideSrBurns], color=['magenta'], label= "SR BURNS")
plt.scatter([MFCCPRUEBA],[CentroidePRUEBA], color=['cyan'], marker = "*",label= "PRUEBA")

plt.xlabel("Centroide")
plt.ylabel("MFCC")
plt.legend()
plt.show()
"""